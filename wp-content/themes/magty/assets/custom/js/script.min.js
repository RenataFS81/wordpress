"use strict";var magty=magty||{};function magtyDomReady(e){if("function"==typeof e){if("interactive"===document.readyState||"complete"===document.readyState)return e();document.addEventListener("DOMContentLoaded",e,!1)}}magty.traverseMenu={init:function(){let e=document.querySelector(".magty-top-nav"),t=document.getElementById("site-navigation");e&&this.traverse(e),t&&this.traverse(t)},traverse:function(e){let t=e.getElementsByTagName("ul")[0];if(void 0!==t){t.classList.contains("nav-menu")||t.classList.add("nav-menu");let a=t.getElementsByTagName("a"),i=t.querySelectorAll(".menu-item-has-children > a, .page_item_has_children > a");for(let o of a)o.addEventListener("focus",this.toggleFocus,!0),o.addEventListener("blur",this.toggleFocus,!0);for(let s of i)s.addEventListener("touchstart",this.toggleFocus,!1)}},toggleFocus:function(e){if("focus"===e.type||"blur"===e.type){let t=this;for(;!t.classList.contains("nav-menu");)"li"===t.tagName.toLowerCase()&&t.classList.toggle("focus"),t=t.parentNode}if("touchstart"===e.type){let a=this.parentNode;for(let i of(e.preventDefault(),a.parentNode.children))a!==i&&i.classList.remove("focus");a.classList.toggle("focus")}}},magty.handleFocus={init:function(){this.keepFocusInModal()},keepFocusInModal:function(){let e=document.querySelectorAll(".magty-canvas-modal");document.addEventListener("keydown",function(t){("Tab"===t.key||9===t.keyCode)&&e&&e.forEach(function(e){let a=e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="search"]:not([disabled]), input[type="submit"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])'),i=a[0],o=a[a.length-1];t.shiftKey?document.activeElement===i&&(o.focus(),t.preventDefault()):document.activeElement===o&&(i.focus(),t.preventDefault())})})}},magty.fadeOutPreloader={init:function(){let e=document.querySelector("#magty-preloader-wrapper");e&&(e.classList.add("fadeOut"),setTimeout(function(){e.style.display="none"},500))}},magty.scrollToTop={init:function(){let e=document.documentElement,t=this,a=document.querySelectorAll(".magty-toggle-scroll-top");a&&a.forEach(function(a){t.goToTop(a,e)});let i=document.querySelectorAll(".magty-floating-scroll-top");i&&i.forEach(function(a){t.scrollToTopPosition(a,e)})},goToTop:function(e,t){e.addEventListener("click",function(e){e.preventDefault(),t.scrollTo({top:0,behavior:"smooth"})})},scrollToTopPosition:function(e,t){window.addEventListener("scroll",function(a){let i=t.scrollHeight-t.clientHeight;t.scrollTop/i>.4?e.classList.add("visible"):e.classList.remove("visible")})}},magty.stickyMenu={init:function(){let e=document.querySelector(".magty-primary-bar-row.sticky-menu");if(e&&e.className.includes("sticky-style-normal")){let t=e.offsetTop+e.clientHeight+100;window.addEventListener("scroll",function(a){let i=window.scrollY;if(i<=e.offsetTop||0===i){e.classList.remove("has-menu-sticked"),e.classList.remove("sticky-menu-translate-up");return}i>e.offsetTop&&(e.classList.add("sticky-menu-translate-up"),e.classList.remove("has-menu-sticked")),i>t&&(e.classList.remove("sticky-menu-translate-up"),e.classList.add("has-menu-sticked"))})}}},magty.subMenuToggle={init:function(){let e=document.querySelectorAll(".sub-menu-toggle");e&&e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),this.classList.toggle("active"),this.setAttribute("aria-selected",`${"true"!==this.getAttribute("aria-selected")}`);let t=this.getAttribute("data-toggle-target");t&&document.querySelector(t).classList.toggle("active")})})}},magty.CanvasModal={init:function(){document.querySelector(".toggle-canvas-modal")&&(this.onOpen(),this.onClose(),this.outsideModal(),this.closeOnEscape())},onOpen:function(){document.querySelectorAll(".toggle-canvas-modal").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),document.body.classList.add("canvas-modal-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),e.classList.add("active"),e.setAttribute("aria-expanded",!0);let a=this.getAttribute("data-focus");a&&setTimeout(function(){document.querySelector(a).focus()},500)})})},onClose:function(){document.querySelectorAll(".close-canvas-modal").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault(),this.hideModal()}).bind(this))}).bind(this))},outsideModal:function(){document.addEventListener("click",(function(e){if(document.body.classList.contains("canvas-modal-is-open")){let t=document.querySelector("#page.site");e.target==t&&this.hideModal()}}).bind(this))},closeOnEscape:function(){document.addEventListener("keydown",(function(e){"Escape"===e.key&&(e.preventDefault(),this.hideModal())}).bind(this))},hideModal:function(){document.body.classList.remove("canvas-modal-is-open");let e=document.querySelector(".toggle-canvas-modal.active");if(e){document.body.classList.remove(e.getAttribute("data-body-class"));let t=e.getAttribute("data-focus");t&&document.querySelector(t).blur(),e.setAttribute("aria-expanded",!1),e.focus(),e.classList.remove("active")}}},magty.SearchBlock={isToggled:!1,init:function(){document.querySelector(".toggle-search-block")&&(this.toggleSearchBlock(),this.closeOnEscape())},toggleSearchBlock:function(){let e=this;document.querySelectorAll(".toggle-search-block").forEach(function(t){t.addEventListener("click",function(a){if(a.preventDefault(),e.isToggled=!e.isToggled,e.isToggled){document.body.classList.add("search-block-is-open"),document.body.classList.add(this.getAttribute("data-body-class")),t.classList.add("active"),t.parentNode.classList.add("active"),t.setAttribute("aria-expanded",!0);let i=this.getAttribute("data-focus");i&&setTimeout(function(){t.parentNode.querySelector(i).focus()},500),setTimeout(function(){e.outsideBlock()},100)}else e.hideBlock()})})},closeOnEscape:function(){let e=this;document.addEventListener("keydown",function(t){"Escape"===t.key&&(t.preventDefault(),e.hideBlock())})},outsideBlock:function(){document.addEventListener("click",this.handleClickOutsideBox)},handleClickOutsideBox:function(e){document.body.classList.contains("search-block-is-open")&&(document.querySelector(".magty-search-toggle.active .em-search-form-inner").contains(e.target)||magty.SearchBlock.hideBlock())},hideBlock:function(){let e=this;document.body.classList.remove("search-block-is-open");let t=document.querySelector(".toggle-search-block.active");if(t){document.body.classList.remove(t.getAttribute("data-body-class"));let a=t.getAttribute("data-focus");a&&t.parentNode.querySelector(a).blur(),t.setAttribute("aria-expanded",!1),t.focus(),t.classList.remove("active"),t.parentNode.classList.remove("active"),document.removeEventListener("click",e.handleClickOutsideBox),e.isToggled=!1}}},magty.setBackgroundImage={init:function(){let e=document.querySelectorAll(".magty-bg-image");e&&e.forEach(function(e){let t=e.querySelector("img");if(t){let a=t.getAttribute("src");a&&(e.style.backgroundImage="url("+a+")",t.style.display="none")}})}},magty.progressBar={init:function(){let e=document.getElementById("magty-progress-bar");if(e){let t=document.body,a=document.documentElement;window.addEventListener("scroll",function(i){let o=t.scrollTop||a.scrollTop,s=a.scrollHeight-a.clientHeight;e.style.width=o/s*100+"%"})}}},magty.slider={init:function(){this.tickerSlider(),this.bannerSlider(),this.widgetSlider()},tickerSlider:function(){let e=document.querySelector(".magty-ticker-slider-wrapper");if(e){let t,a=e.getAttribute("data-slider")||{};a&&(t=JSON.parse(a)),new Swiper(e,t)}},bannerSlider:function(){let e=document.querySelector(".magty-banner-wrapper");if(e){let t,a=e.getAttribute("data-banner")||{};a&&(t=JSON.parse(a));let i={loop:!0,...t};new Swiper(e,i)}},widgetSlider:function(){let e=document.querySelectorAll(".magty-slider-wrapper-block .swiper");e&&e.forEach(function(e){let t=e.parentNode,a=t.querySelector(".swiper-button-next"),i=t.querySelector(".swiper-button-prev"),o=t.querySelector(".swiper-pagination"),s=e.getAttribute("data-slider")||{};if(s)var n=JSON.parse(s);let l={slidesPerView:1,lazyloading:!0,navigation:{nextEl:a,prevEl:i},pagination:{el:o,clickable:!0},...n},r=new Swiper(e,l);e.clientWidth<500&&(r.params.slidesPerView=1,r.update())})}},magty.tabs={init:function(){let e=document.querySelectorAll("[data-toggle='uf-tab']");e&&e.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();let a=[...e.parentNode.children],i=[...e.parentNode.nextElementSibling.children,];a.forEach(e=>{e.classList.remove("active"),e.setAttribute("aria-selected","false")}),i.forEach(e=>{e.classList.remove("active")});let o=e.getAttribute("aria-controls"),s=document.getElementById(o);e.classList.add("active"),e.setAttribute("aria-selected","true"),s.classList.add("active")})})}},magty.displayTime={init:function(){let e=document.querySelector(".magty-components-time");if(e){let t=JSON.parse(e.getAttribute("data-settings"));if(t){let a=Intl.DateTimeFormat().resolvedOptions().timeZone;t.timeZone=a,setInterval(function(){var a=new Date().toLocaleTimeString("en-US",t);e.innerHTML=a},1e3)}}}},magty.loadPosts={canBeLoaded:!0,currentPage:0,nextPage:0,maxPage:0,template:"",loadButton:"",loader:"",postsListsWrapper:"",loadType:"",init:function(){let e=document.querySelector(".magty-load-posts-btn-wrapper");if(e){let t=this;t.currentPage=parseInt(e.getAttribute("data-page")),t.nextPage=t.currentPage+1,t.maxPage=parseInt(e.getAttribute("data-max-pages")),t.template=e.closest("#primary").getAttribute("data-template"),t.loadButton=document.querySelector(".magty-ajax-load-btn"),t.loader=document.querySelector(".magty-ajax-loader"),t.postsListsWrapper=document.querySelector(".magty-posts-lists"),t.loadType=e.getAttribute("data-load-type"),t.loadType||(t.loadType="button_click_load"),"button_click_load"==t.loadType&&t.loadButton.addEventListener("click",function(e){e.preventDefault(),t.canBeLoaded&&t.fetchThePosts()}),"infinite_scroll_load"==t.loadType&&(e.style.opacity=.7,window.addEventListener("scroll",function(a){let i=e.getBoundingClientRect().top-window.innerHeight<=400;t.nextPage<=t.maxPage&&i&&t.canBeLoaded&&t.fetchThePosts()}))}},fetchThePosts:function(){let e=this;e.canBeLoaded=!1,e.loadButton.classList.add("loading-posts"),e.loader.classList.add("active");let t={action:"magty_load_posts",load_post_nonce:MagtyVars.load_post_nonce,query_vars:MagtyVars.query_vars,page:e.nextPage,template:e.template};fetch(MagtyVars.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}).then(e=>e.json()).then(t=>{if(t.success){let a=t.data.content.join("");magty.createElementsFromString(a).forEach(t=>{t.classList.add("animatefadeIn"),e.postsListsWrapper.appendChild(t)}),e.currentPage=e.nextPage,e.nextPage++,e.canBeLoaded=!0,e.nextPage<=e.maxPage?(e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")):document.querySelector(".magty-load-posts-btn-wrapper").style.display="none",document.body.dispatchEvent(new Event("posts-loaded"))}else e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")}).catch(t=>{console.error("Error during fetch:",t),e.loadButton.classList.remove("loading-posts"),e.loader.classList.remove("active")})}},magty.createElementsFromString=function(e){let t=new DOMParser,a=t.parseFromString(e,"text/html");return Array.from(a.body.children)},magtyDomReady(function(){magty.stickyMenu.init(),magty.subMenuToggle.init(),magty.traverseMenu.init(),magty.handleFocus.init(),magty.CanvasModal.init(),magty.SearchBlock.init(),magty.scrollToTop.init(),magty.setBackgroundImage.init(),magty.progressBar.init(),magty.slider.init(),magty.tabs.init(),magty.displayTime.init(),magty.loadPosts.init()}),window.addEventListener("load",function(e){magty.fadeOutPreloader.init()});